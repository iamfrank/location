<!doctype html>
<html class="no-js" lang="en" manifest="cache.manifest">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Location</title>
        <meta name="description" content="A simple web application to track and display geolocations">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        
        <!-- Enable iOS standalone mode for home screen -->
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-title" content="Geolocation App">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon" href="apple-touch-icon.png">

        <link rel="stylesheet" href="css/normalize.min.css">
        <style>
            
            
            body {
                background-color: #122;
                color: #fff;
                font: 1rem/1.3 Roboto, sans-serif;
                padding: 2rem;
            }
            
            
        </style>
        <link rel="manifest" href="manifest.json">
        <link rel="icon" href="apple-touch-icon.png" type="image/png">
    </head>
    <body>
        <main id="location"></main>
        <script>
            
            
            /*
            * Javascript for Geolocation webapp
            */
           
           var x = document.getElementById("location");
           
           function getLocation() {
               if ("geolocation" in navigator) {
                   navigator.geolocation.watchPosition(showPosition, showError);
               } else {
                   x.innerHTML = "Geolocation is not supported by this browser.";
               }
           }
           
           function showPosition(position) {
               x.innerHTML = "Latitude: " + position.coords.latitude
                           + "<br>Longitude: " + position.coords.longitude
                           + "<br>Accuracy: " + position.coords.accuracy
                           + "<br>Altitude: " + position.coords.altitude
                           + "<br>Altitude accuracy: " + position.coords.altitudeAccuracy
                           + "<br>Heading: " + position.coords.heading
                           + "<br>Timestamp: " + position.coords.timestamp;
           }
           
           function showError(error) {
               switch(error.code) {
                   case error.PERMISSION_DENIED:
                       x.innerHTML = "User denied the request for Geolocation."
                       break;
                   case error.POSITION_UNAVAILABLE:
                       x.innerHTML = "Location information is unavailable."
                       break;
                   case error.TIMEOUT:
                       x.innerHTML = "The request to get user location timed out."
                       break;
                   case error.UNKNOWN_ERROR:
                       x.innerHTML = "An unknown error occurred."
                       break;
                   default:
                       x.innerHTML = "Something strange is going on."
               }
           }
           
           getLocation();
           
           
           /*
            * Register service worker
            * (Does nothing at present. Is needed to display Chrome install web app banner.)
            */
           
           if ('serviceWorker' in navigator) {
             window.addEventListener('load', function() {
               navigator.serviceWorker.register('../dist/sw.js').then(function(registration) {
                 // Registration was successful
                 console.log('ServiceWorker registration successful with scope: ', registration.scope);
               }).catch(function(err) {
                 // registration failed :(
                 console.log('ServiceWorker registration failed: ', err);
               });
             });
           }

            
        </script>
    </body>
</html>
